<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Document</title>
    <style>
         body {
            padding: 0;
            margin: 0;
            width: 100%;
            overflow-x: hidden;
            background-color: #F7F8FF;
            max-width: 400px;
            background-color: black;
            margin: auto;
        }

        @media (max-width:500px) {
            body{
                width: 100%;
                max-width: unset;
            }
        }
    </style>
</head>
<body>
    <div style="background-color: white; min-height: 100vh;">
   <div style="height: 8vh; width: 100%;display: flex;flex-direction: row;justify-content: space-evenly;align-items: center;background: white;box-shadow: 5px 10px 8px 0px rgb(0 0 0 / 8%);">
        <i onclick="window.history.back()" class="fa-solid fa-angle-left"></i>
        <div style="height: 8vh;width: 89%;display: flex;justify-content: center;">
             <p style="margin-bottom: 0%;font-size: 18px;margin-top: 4%;">Invitation bonus</p>
        </div>
   </div>
   <div style="background: linear-gradient(94deg, #f99937 2.72%, #ff6922 43.54%, #ff8039 98.54%);height: 26vh;">
      <div style="background-image: url(/images/bannerInvitation.png);height: 26vh;width: 100%;background-repeat: no-repeat;background-size: cover;">
          <div style="height: 21vh;width: 58%;display: flex;flex-direction: column;justify-content: center;align-items: center;">
              <div style="height: 5vh;width: 93%;color: white;font-weight: 400;font-size: 17px;display: flex;align-items: center;">
                  Invite friends and deposit
              </div>
              <div style="height: 4vh;width: 93%;font-size: 12px;color: white;">
                  Both parties can receive rewards
              </div>
              <div style="height: 5vh;width: 93%;font-size: 11px;color: white;line-height: 11px;">
                Invite friends to register and recharge to receive rewards
              </div>
              <div style="height: 4vh;width: 93%;font-size: 12px;color: white;">
                activity date
            </div>
            <div style="height: 3vh;width: 93%;font-size: 18px;color: white;line-height: 11px;">
              2023-12-18-2024-12-30
              </div>
          </div>
      </div>
   </div>
   <div style="height: 14vh;width: 90%;border-radius: 8px;position: relative;bottom: 12px;left: 5%;background: white;display: flex;flex-direction: row;justify-content: space-around;align-items: center;box-shadow: 5px 10px 8px 0px rgb(0 0 0 / 8%);">
      <div style="height: 13vh;width: 47%;display: flex;flex-direction: column;justify-content: center;align-items: center;" onclick="window.location.href='/activity/invitationBonusRules'">
           <img src="/images/inviteRule.svg" alt="" style="width: 32%;height: auto;"/>   
           <p style="color: #768096;margin-bottom: 0%;font-size: 12px;">Invitation reward rules</p> 
      </div>
      <!-- <div style="height: 13vh;width: 47%;display: flex;flex-direction: column;justify-content: center;align-items: center;">
           <img src="./image/inivtieRecord.svg" alt="" style="width: 32%;height: auto;"/>   
           <p style="color: #768096;margin-bottom: 0%;font-size: 12px;">Invitation record</p>  
       </div> -->
   </div>
   <% invitationMetrix.forEach((task, index)=> { %>
   <div style="width: 100%;height: 45vh;display: flex;justify-content: center;align-items: center;">
   
      <div style="width: 93%;height: 38vh;border-radius: 8px;box-shadow: 5px 10px 8px 0px rgb(0 0 0 / 8%);">
          <div style="height: 6vh;display: flex;flex-direction: row;justify-content: space-between;align-items: center;border-bottom: 1px solid  #E1E1E1;">
              <div style="width: 41%;height: 6vh;border-top-left-radius: 8px;border-bottom-right-radius: 21px;background-color: #18B660;display: flex;flex-direction: row;justify-content: space-between;align-items: center;">
                  <div style="width: 48%;height: 6vh;display: flex;justify-content: center;align-items: center;">
                       <p style="color: #fff;margin-bottom: 0%;font-size: 13px;">Bonus <span style="background: white;border-radius: 50%;padding: 1px 6px;color: #B6BCC8;font-size: 11px;font-weight: bold;">1</span></p>
                   </div>
                   <div style="width: 40%;height: 6vh;display: flex;justify-content: center;align-items: center;">
                       <img src="/images/close.svg" alt="close" style="width: 40%;height: auto;margin-left: 4px;"/>
                   </div>
              </div>
              <div style="width: 18%;height: 6vh;color: #FEAA57;font-weight: 600;display: flex;justify-content: center;align-items: center;font-size: 13px;">
                   ₹<%= task.Bonus %>
              </div>
          </div>
          
          <div style="height: 10vh;width: 100%;display: flex;flex-direction: column;justify-content: space-around;align-items: center;margin-top: 8px;">
              <div style="background: #e4e4e4;height: 4vh;width: 93%;display: flex;flex-direction: row;justify-content: space-between;align-items: center;">
                  <div style="width: 40%;height: 3vh;font-size: 12px;display: flex;justify-content: center;align-items: center;">
                       Number of invitees
                  </div>
                  <div style="width: 50%;height: 3vh;font-size: 14px;display: flex;justify-content: center;align-items: center;">
                    <%= task.team %>
                  </div>
              </div>
              <div style="background: #e4e4e4;height: 4vh;width: 93%;display: flex;flex-direction: row;justify-content: space-between;align-items: center;">
                <div style="width: 40%;height: 3vh;font-size: 12px;display: flex;justify-content: center;align-items: center;">
                    Recharge per people
                </div>
                <div style="width: 50%;height: 3vh;font-size: 14px;display: flex;justify-content: center;align-items: center;color: #FB5B5B;">
                    ₹<%= task.deposit %>
                </div>
            </div>
          </div>
          <div style="height: 2vh;display: flex;justify-content: center;align-items: center;">
              <div style="height: 2vh;border-bottom: 1px solid  #E1E1E1;width: 90%;"></div>
          </div>
          <div style="height: 10vh;width: 100%;display: flex;flex-direction: row;justify-content: space-around;align-items: center;">
             <div style="width: 50%;height: 8vh;display: flex;flex-direction: column;justify-content: center;align-items: center;border-right: 1px solid  #E1E1E1;">
                 <p style="color: #FEAA57;margin-bottom: 0%;"><%= totalMember >= task.team ? task.team : totalMember %> /<%= task.team %></p>
                 <p style="margin-bottom: 0%;color: #768096;font-size: 12px;">Number of invitees</p>
             </div>
             <div style="width: 50%;height: 8vh;display: flex;flex-direction: column;justify-content: center;align-items: center;">
                <p style="color: #FEAA57;margin-bottom: 0%;color: #FB5B5B;"><%= activecount >= task.team ? task.team : activecount %> /<%= task.team %></p>
                <p style="margin-bottom: 0%;color: #768096;font-size: 12px;">Deposit Number</p>
            </div>
          </div>
          <div style="height: 6vh;width: 100%;display: flex;justify-content: center;align-items: center;">
               <!-- <button style="background: #76809666;width: 95%;height: 5vh;border: none;border-radius: 25px;color: white;font-weight: bold;">Unfinished</button> -->
               <% if (totalMember >= task.team && claimedArray[index] === 0) { %>
                <button style="background: #1cb411;width: 95%;height: 5vh;border: none;border-radius: 25px;color: white;font-weight: bold;" onclick="handleClaim(<%= task.Bonus %>,<%= index %>)">Claim</button>
                <% } else { %>
                   
                <button style="background: #76809666 ;width: 95%;height: 5vh;border: none;border-radius: 25px;color: white;font-weight: bold;"  disabled><%= claimedArray[index] === 0 ? "Unfinished" : "Claimed" %></button>
                <% } %>
          </div>
      </div>
     
   </div>
   <% }); %>
</div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script>
         async function handleClaim(amount,index) {
            try {
                const response = await axios.post('/invitationReward/claim', { index, amount});
                const iconType = response.status ? "success" : "error";
                swal({
                    title: response.data.status ? "Success!" : "Error!",
                    text: response.data.message,
                    icon: iconType,
                    buttons: false, // No buttons
                    timer: 2000, // Automatically close after 2 seconds
                });

                if(response.data.status){
                    setTimeout(()=>{
                        window.location.reload();
                    },2000)
                }

            } catch (error) {
                console.error('Error claiming reward:', error);
            }
        }

    </script>
</body>
</html>